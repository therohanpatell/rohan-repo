{
  "dq_checks": [
    {
      "check_id": "NUMERIC_001",
      "category": "Completeness",
      "sql_query": "SELECT COUNT(*) as total_records FROM `your-project.your_dataset.source_table`",
      "description": "Verify total record count is greater than 0",
      "severity": "High",
      "expected_output": ">0",
      "comparison_type": "numeric_condition",
      "impacted_downstream": ["All Reports", "Data Warehouse"],
      "tags": ["completeness", "count_check"],
      "active": true
    },
    {
      "check_id": "NUMERIC_002",
      "category": "Completeness",
      "sql_query": "SELECT COUNT(*) as null_count FROM `your-project.your_dataset.source_table` WHERE required_field IS NULL",
      "description": "Ensure no null values in required field",
      "severity": "High",
      "expected_output": "0",
      "comparison_type": "numeric_condition",
      "impacted_downstream": ["Customer Dashboard", "API Services"],
      "tags": ["completeness", "null_check"],
      "active": true
    },
    {
      "check_id": "NUMERIC_003",
      "category": "Completeness",
      "sql_query": "SELECT COUNT(*) as missing_count FROM `your-project.your_dataset.source_table` WHERE important_column = '' OR important_column IS NULL",
      "description": "Check for empty or missing important values",
      "severity": "Medium",
      "expected_output": "<=10",
      "comparison_type": "numeric_condition",
      "impacted_downstream": ["Analytics Team", "ML Models"],
      "tags": ["completeness", "data_quality"],
      "active": true
    },
    {
      "check_id": "NUMERIC_004",
      "category": "Uniqueness",
      "sql_query": "SELECT COUNT(*) as total_count FROM `your-project.your_dataset.users`",
      "description": "Total user count should be reasonable",
      "severity": "Medium",
      "expected_output": ">=1000",
      "comparison_type": "numeric_condition",
      "impacted_downstream": ["User Analytics", "Growth Team"],
      "tags": ["uniqueness", "volume_check"],
      "active": true
    },
    {
      "check_id": "NUMERIC_005",
      "category": "Uniqueness",
      "sql_query": "SELECT COUNT(DISTINCT user_id) as unique_users FROM `your-project.your_dataset.users`",
      "description": "Count of unique users should match total count",
      "severity": "High",
      "expected_output": "==total_count",
      "comparison_type": "numeric_condition",
      "impacted_downstream": ["User Management", "Billing System"],
      "tags": ["uniqueness", "deduplication"],
      "active": true
    },
    {
      "check_id": "NUMERIC_006",
      "category": "Uniqueness",
      "sql_query": "SELECT COUNT(*) - COUNT(DISTINCT email) as duplicate_emails FROM `your-project.your_dataset.users`",
      "description": "Check for duplicate email addresses",
      "severity": "High",
      "expected_output": "0",
      "comparison_type": "numeric_condition",
      "impacted_downstream": ["Authentication System", "CRM"],
      "tags": ["uniqueness", "duplicate_check"],
      "active": true
    },
    {
      "check_id": "NUMERIC_007",
      "category": "Validity",
      "sql_query": "SELECT COUNT(*) as invalid_dates FROM `your-project.your_dataset.events` WHERE event_date > CURRENT_DATE()",
      "description": "Check for future dates in event data",
      "severity": "Medium",
      "expected_output": "0",
      "comparison_type": "numeric_condition",
      "impacted_downstream": ["Event Analytics", "Reporting"],
      "tags": ["validity", "date_check"],
      "active": true
    },
    {
      "check_id": "NUMERIC_008",
      "category": "Validity",
      "sql_query": "SELECT COUNT(*) as negative_amounts FROM `your-project.your_dataset.transactions` WHERE amount < 0",
      "description": "Ensure no negative transaction amounts",
      "severity": "High",
      "expected_output": "0",
      "comparison_type": "numeric_condition",
      "impacted_downstream": ["Finance Team", "Accounting System"],
      "tags": ["validity", "business_rule"],
      "active": true
    },
    {
      "check_id": "NUMERIC_009",
      "category": "Validity",
      "sql_query": "SELECT COUNT(*) as extreme_values FROM `your-project.your_dataset.products` WHERE price > 10000 OR price < 1",
      "description": "Check for extreme price values",
      "severity": "Medium",
      "expected_output": "<=5",
      "comparison_type": "numeric_condition",
      "impacted_downstream": ["Pricing Team", "E-commerce"],
      "tags": ["validity", "outlier_detection"],
      "active": true
    },
    {
      "check_id": "NUMERIC_010",
      "category": "Consistency",
      "sql_query": "SELECT AVG(order_amount) as avg_order_value FROM `your-project.your_dataset.orders` WHERE order_date >= DATE_SUB(CURRENT_DATE(), INTERVAL 30 DAY)",
      "description": "Average order value should be within expected range",
      "severity": "Medium",
      "expected_output": ">=50",
      "comparison_type": "numeric_condition",
      "impacted_downstream": ["Sales Dashboard", "Revenue Reporting"],
      "tags": ["consistency", "kpi_check"],
      "active": true
    },
    {
      "check_id": "NUMERIC_011",
      "category": "Consistency",
      "sql_query": "SELECT COUNT(*) as high_value_orders FROM `your-project.your_dataset.orders` WHERE order_amount > 1000",
      "description": "Count of high-value orders should be reasonable",
      "severity": "Low",
      "expected_output": "<=100",
      "comparison_type": "numeric_condition",
      "impacted_downstream": ["Fraud Detection", "VIP Sales"],
      "tags": ["consistency", "volume_check"],
      "active": true
    },
    {
      "check_id": "NUMERIC_012",
      "category": "Consistency",
      "sql_query": "SELECT MAX(age) as max_age FROM `your-project.your_dataset.customers`",
      "description": "Maximum customer age should be realistic",
      "severity": "Medium",
      "expected_output": "<=120",
      "comparison_type": "numeric_condition",
      "impacted_downstream": ["Customer Analytics", "Marketing"],
      "tags": ["consistency", "data_validation"],
      "active": true
    },
    {
      "check_id": "NUMERIC_013",
      "category": "Accuracy",
      "sql_query": "SELECT SUM(revenue) as total_revenue FROM `your-project.your_dataset.sales` WHERE sale_date = CURRENT_DATE()",
      "description": "Daily revenue should meet minimum threshold",
      "severity": "High",
      "expected_output": ">=10000",
      "comparison_type": "numeric_condition",
      "impacted_downstream": ["Executive Dashboard", "Finance"],
      "tags": ["accuracy", "revenue_check"],
      "active": true
    },
    {
      "check_id": "NUMERIC_014",
      "category": "Accuracy",
      "sql_query": "SELECT COUNT(*) as failed_transactions FROM `your-project.your_dataset.payments` WHERE status = 'FAILED'",
      "description": "Failed transaction rate should be below threshold",
      "severity": "High",
      "expected_output": "<=total_transactions*0.05",
      "comparison_type": "numeric_condition",
      "impacted_downstream": ["Payment Processing", "Customer Support"],
      "tags": ["accuracy", "error_rate"],
      "active": true
    },
    {
      "check_id": "NUMERIC_015",
      "category": "Accuracy",
      "sql_query": "SELECT AVG(delivery_days) as avg_delivery_time FROM `your-project.your_dataset.orders` WHERE delivered_date IS NOT NULL",
      "description": "Average delivery time should meet SLA",
      "severity": "Medium",
      "expected_output": "<=7",
      "comparison_type": "numeric_condition",
      "impacted_downstream": ["Operations", "Customer Experience"],
      "tags": ["accuracy", "sla_check"],
      "active": true
    },
    {
      "check_id": "NUMERIC_016",
      "category": "Timeliness",
      "sql_query": "SELECT COUNT(*) as stale_records FROM `your-project.your_dataset.products` WHERE last_updated_date < DATE_SUB(CURRENT_DATE(), INTERVAL 90 DAY)",
      "description": "Check for stale product records",
      "severity": "Low",
      "expected_output": "<=100",
      "comparison_type": "numeric_condition",
      "impacted_downstream": ["Product Catalog", "Inventory Management"],
      "tags": ["timeliness", "freshness_check"],
      "active": true
    },
    {
      "check_id": "NUMERIC_017",
      "category": "Timeliness",
      "sql_query": "SELECT COUNT(*) as pending_orders FROM `your-project.your_dataset.orders` WHERE status = 'PENDING' AND created_date < DATE_SUB(CURRENT_DATE(), INTERVAL 7 DAY)",
      "description": "Old pending orders should be minimal",
      "severity": "Medium",
      "expected_output": "<=10",
      "comparison_type": "numeric_condition",
      "impacted_downstream": ["Order Management", "Customer Service"],
      "tags": ["timeliness", "aging_check"],
      "active": true
    },
    {
      "check_id": "NUMERIC_018",
      "category": "Timeliness",
      "sql_query": "SELECT TIMESTAMP_DIFF(CURRENT_TIMESTAMP(), MAX(event_timestamp), MINUTE) as minutes_since_last_event FROM `your-project.your_dataset.events`",
      "description": "Data should be updated recently",
      "severity": "High",
      "expected_output": "<=60",
      "comparison_type": "numeric_condition",
      "impacted_downstream": ["Real-time Analytics", "Monitoring"],
      "tags": ["timeliness", "latency_check"],
      "active": true
    },
    {
      "check_id": "NUMERIC_019",
      "category": "Distribution",
      "sql_query": "SELECT COUNT(*) as us_customers FROM `your-project.your_dataset.customers` WHERE country = 'US'",
      "description": "US customers should be majority",
      "severity": "Medium",
      "expected_output": ">=total_customers*0.6",
      "comparison_type": "numeric_condition",
      "impacted_downstream": ["Regional Analysis", "Marketing"],
      "tags": ["distribution", "geographic_check"],
      "active": true
    },
    {
      "check_id": "NUMERIC_020",
      "category": "Distribution",
      "sql_query": "SELECT COUNT(*) as premium_users FROM `your-project.your_dataset.users` WHERE plan_type = 'PREMIUM'",
      "description": "Premium user percentage should meet target",
      "severity": "High",
      "expected_output": ">=total_users*0.15",
      "comparison_type": "numeric_condition",
      "impacted_downstream": ["Revenue Analysis", "Product Strategy"],
      "tags": ["distribution", "segmentation"],
      "active": true
    },
    {
      "check_id": "NUMERIC_021",
      "category": "Distribution",
      "sql_query": "SELECT COUNT(*) as mobile_users FROM `your-project.your_dataset.sessions` WHERE device_type = 'MOBILE'",
      "description": "Mobile traffic should be significant",
      "severity": "Medium",
      "expected_output": ">=total_sessions*0.4",
      "comparison_type": "numeric_condition",
      "impacted_downstream": ["Mobile Team", "UX Design"],
      "tags": ["distribution", "platform_check"],
      "active": true
    },
    {
      "check_id": "NUMERIC_022",
      "category": "Business Rules",
      "sql_query": "SELECT COUNT(*) as free_trials FROM `your-project.your_dataset.subscriptions` WHERE plan_type = 'TRIAL' AND trial_end_date < CURRENT_DATE()",
      "description": "Expired trials should be converted or canceled",
      "severity": "High",
      "expected_output": "<=50",
      "comparison_type": "numeric_condition",
      "impacted_downstream": ["Sales Team", "Customer Success"],
      "tags": ["business_rules", "conversion"],
      "active": true
    },
    {
      "check_id": "NUMERIC_023",
      "category": "Business Rules",
      "sql_query": "SELECT COUNT(*) as high_risk_orders FROM `your-project.your_dataset.orders` WHERE amount > 5000 AND customer_tenure_days < 30",
      "description": "High-risk new customer orders should be reviewed",
      "severity": "High",
      "expected_output": "<=5",
      "comparison_type": "numeric_condition",
      "impacted_downstream": ["Fraud Prevention", "Risk Management"],
      "tags": ["business_rules", "risk_assessment"],
      "active": true
    },
    {
      "check_id": "NUMERIC_024",
      "category": "Business Rules",
      "sql_query": "SELECT COUNT(*) as low_performance_products FROM `your-project.your_dataset.products` WHERE sales_count < 10 AND created_date < DATE_SUB(CURRENT_DATE(), INTERVAL 180 DAY)",
      "description": "Low-performing products should be minimal",
      "severity": "Medium",
      "expected_output": "<=total_products*0.1",
      "comparison_type": "numeric_condition",
      "impacted_downstream": ["Product Management", "Inventory"],
      "tags": ["business_rules", "performance"],
      "active": true
    },
    {
      "check_id": "NUMERIC_025",
      "category": "Integration",
      "sql_query": "SELECT COUNT(*) as missing_customers FROM `your-project.your_dataset.orders` o LEFT JOIN `your-project.your_dataset.customers` c ON o.customer_id = c.customer_id WHERE c.customer_id IS NULL",
      "description": "Orders should have valid customer references",
      "severity": "High",
      "expected_output": "0",
      "comparison_type": "numeric_condition",
      "impacted_downstream": ["Data Integration", "CRM System"],
      "tags": ["integration", "referential_integrity"],
      "active": true
    },
    {
      "check_id": "NUMERIC_026",
      "category": "Integration",
      "sql_query": "SELECT COUNT(*) as data_discrepancy FROM (SELECT COUNT(*) as source_count FROM `your-project.your_dataset.source_system` UNION ALL SELECT COUNT(*) as target_count FROM `your-project.your_dataset.target_system`)",
      "description": "Source and target system counts should match",
      "severity": "High",
      "expected_output": "==2",
      "comparison_type": "numeric_condition",
      "impacted_downstream": ["ETL Processes", "Data Warehouse"],
      "tags": ["integration", "reconciliation"],
      "active": true
    },
    {
      "check_id": "NUMERIC_027",
      "category": "Integration",
      "sql_query": "SELECT SUM(amount) as total_amount FROM `your-project.your_dataset.transactions`",
      "description": "Total transaction amount should match finance system",
      "severity": "High",
      "expected_output": "==expected_total_amount",
      "comparison_type": "numeric_condition",
      "impacted_downstream": ["Finance", "Audit"],
      "tags": ["integration", "financial_reconciliation"],
      "active": true
    },
    {
      "check_id": "NUMERIC_028",
      "category": "Performance",
      "sql_query": "SELECT COUNT(*) as slow_queries FROM `your-project.your_dataset.query_logs` WHERE execution_time_seconds > 30 AND query_date = CURRENT_DATE()",
      "description": "Slow queries should be minimal",
      "severity": "Medium",
      "expected_output": "<=5",
      "comparison_type": "numeric_condition",
      "impacted_downstream": ["Database Admin", "Performance Team"],
      "tags": ["performance", "monitoring"],
      "active": true
    },
    {
      "check_id": "NUMERIC_029",
      "category": "Performance",
      "sql_query": "SELECT AVG(response_time_ms) as avg_api_response FROM `your-project.your_dataset.api_logs` WHERE timestamp >= TIMESTAMP_SUB(CURRENT_TIMESTAMP(), INTERVAL 1 HOUR)",
      "description": "API response time should meet SLA",
      "severity": "High",
      "expected_output": "<=500",
      "comparison_type": "numeric_condition",
      "impacted_downstream": ["API Team", "Customer Experience"],
      "tags": ["performance", "sla"],
      "active": true
    },
    {
      "check_id": "NUMERIC_030",
      "category": "Performance",
      "sql_query": "SELECT COUNT(*) as error_requests FROM `your-project.your_dataset.server_logs` WHERE status_code >= 500 AND timestamp >= TIMESTAMP_SUB(CURRENT_TIMESTAMP(), INTERVAL 1 HOUR)",
      "description": "Server error rate should be low",
      "severity": "High",
      "expected_output": "<=total_requests*0.01",
      "comparison_type": "numeric_condition",
      "impacted_downstream": ["DevOps", "Engineering"],
      "tags": ["performance", "error_rate"],
      "active": true
    }
  ]
}
